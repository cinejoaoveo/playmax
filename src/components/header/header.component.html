<header class="fixed top-0 left-0 right-0 z-50 bg-gradient-to-b from-black/80 to-transparent p-4 transition-all duration-300">
  <div class="container mx-auto flex items-center justify-between">
    <a routerLink="/home">
      <img src="https://i.ibb.co/svR50X1n/playmax-logo.png" alt="PlayMax Logo" class="w-36 h-auto">
    </a>
    <nav class="hidden md:flex items-center space-x-4 bg-black/30 backdrop-blur-sm px-6 py-2 rounded-full">
      @for (link of navLinks; track link.path) {
        <a 
          [routerLink]="link.path" 
          routerLinkActive="bg-white/10 text-white"
          [routerLinkActiveOptions]="{ exact: true }"
          class="flex items-center space-x-2 px-4 py-2 rounded-full text-gray-300 hover:bg-white/10 hover:text-white transition-colors duration-200">
          <span [innerHTML]="getIcon(link.icon)"></span>
          <span>{{ link.label }}</span>
        </a>
      }
    </nav>
     <div class="flex items-center space-x-2">
        <button (click)="toggleSearch()" class="text-gray-300 hover:text-white p-2 rounded-full hover:bg-white/10">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
        </button>
        <div class="hidden md:block relative">
          @if (firebaseService.currentUser(); as user) {
            <button (click)="isUserMenuOpen.set(!isUserMenuOpen())" class="w-10 h-10 rounded-full bg-pink-500 flex items-center justify-center font-bold text-xl">
              {{ user.email?.charAt(0).toUpperCase() }}
            </button>
            @if(isUserMenuOpen()) {
              <div class="absolute right-0 mt-2 w-48 bg-gray-800 rounded-md shadow-lg py-1 z-50">
                <a routerLink="/watchlist" (click)="isUserMenuOpen.set(false)" class="block px-4 py-2 text-sm text-gray-200 hover:bg-gray-700">Minha Lista</a>
                <a (click)="signOut()" class="block w-full text-left px-4 py-2 text-sm text-gray-200 hover:bg-gray-700 cursor-pointer">Sair</a>
              </div>
            }
          } @else {
            <a routerLink="/auth" class="text-gray-300 hover:text-white px-4 py-2 rounded-full hover:bg-white/10 font-semibold">
              Minha Conta
            </a>
          }
        </div>
      </div>
  </div>
  <!-- Mobile Nav -->
  <nav class="md:hidden fixed bottom-0 left-0 right-0 bg-black/80 backdrop-blur-sm p-2 flex justify-around">
      @for (link of navLinks; track link.path) {
        <a 
          [routerLink]="link.path" 
          routerLinkActive="text-pink-500"
          [routerLinkActiveOptions]="{ exact: true }"
          class="flex flex-col items-center space-y-1 text-gray-300 hover:text-white transition-colors duration-200 text-xs w-1/5">
          <span [innerHTML]="getIcon(link.icon, 'h-5 w-5')"></span>
          <span>{{ link.label }}</span>
        </a>
      }
       <button (click)="toggleSearch()" class="flex flex-col items-center space-y-1 text-gray-300 hover:text-white transition-colors duration-200 text-xs w-1/5">
        <span [innerHTML]="getIcon('search', 'h-5 w-5')"></span>
        <span>Buscar</span>
      </button>
       @if(firebaseService.currentUser(); as user) {
         <a routerLink="/watchlist" routerLinkActive="text-pink-500" class="flex flex-col items-center space-y-1 text-gray-300 hover:text-white transition-colors duration-200 text-xs w-1/5">
            <span [innerHTML]="getIcon('account', 'h-5 w-5')"></span>
            <span>Minha Lista</span>
         </a>
       } @else {
          <a routerLink="/auth" routerLinkActive="text-pink-500" class="flex flex-col items-center space-y-1 text-gray-300 hover:text-white transition-colors duration-200 text-xs w-1/5">
            <span [innerHTML]="getIcon('account', 'h-5 w-5')"></span>
            <span>Conta</span>
          </a>
       }
  </nav>
</header>

@if (isSearchOpen()) {
  <app-search (close)="toggleSearch()"></app-search>
}